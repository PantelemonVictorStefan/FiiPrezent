@model EventViewModel

@{
    ViewBag.Title = "Event Details";
    Layout = "_Layout";
}

<h2>@Model.Name</h2>
<span>@Model.Description</span>

<ol id="participants">
    @foreach (string participant in @Model.Participants)
    {
        <li>@participant</li>
    }
</ol>


@section Scripts
{
    <script>
        var participantsList = document.getElementById("participants");
        var connection = new signalR.HubConnection("/participants");
        
        function appendParticipant(name) {
            var li = document.createElement("li");
            li.innerText = name;
            participantsList.appendChild(li);
        }

        connection.on('Update', (list) => {
            participantsList.innerHTML = "";
            list.forEach(function (el) {
                appendParticipant(el);
            });
        });

        connection.start().then(function () {
            connection.invoke("JoinEventRoom", "@Model.Id");
        });
    </script>
}
